function Face_API_Get_Comment_Post_And_Content(){document.getElementById("MessengerArea_Messenger").innerHTML='<div id="MessengerArea_Messenger_Post_Area"><\/div><div id="MessengerArea_Messenger_Content_Area"><\/div>';Face_API_Get_Comment_Post();Face_API_Get_Comment()}function Face_API_Get_Comment_Post(){if(face_value_current_comment!=""){xhrRequestFacebook_Post&&xhrRequestFacebook_Post.readyState!=4&&xhrRequestFacebook_Post.abort();face_data_post=[];let n=facebook_link_post.replace("{post_id}",face_value_current_post).replace("{version}",facebook_version);n=n+"&access_token="+Face_Get_Token_Access_From_PageID(face_value_current_page);xhrRequestFacebook_Post=$.ajax({url:n,dataType:"json",type:"GET",data:JSON.stringify({}),contentType:"application/json; charset=utf-8","async":!0,error:function(n){Face_Error_API(1,n.responseJSON!=undefined?n.responseJSON.error.message:"");xhrRequestFacebook&&xhrRequestFacebook.readyState!=4&&xhrRequestFacebook.abort()},success:function(n){if(n.hasOwnProperty("id")){let t={};t.full_picture=n.hasOwnProperty("full_picture")?n.full_picture:"";t.permalink_url=n.permalink_url;t.created_time=n.created_time;t.from_id=n.from.id;t.from_name=n.from.name;t.message=n.message;face_data_post.push(t);Face_Render_API_Post(face_data_post,"MessengerArea_Messenger_Post_Area");Face_SH_Complete_LoadDetail_Comment()}else Face_Error_API(1,"Something wrongs in get object post")},beforeSend:function(){Face_SH_Begin_LoadDetail()}})}}function Face_API_Get_Comment(){if(face_value_current_comment!=""){xhrRequestFacebook&&xhrRequestFacebook.readyState!=4&&xhrRequestFacebook.abort();face_data_comment=[];let n=facebook_link_comment_detail.replace("{comment_id}",face_value_current_comment).replace("{version}",facebook_version);n=n+"&access_token="+Face_Get_Token_Access_From_PageID(face_value_current_page);xhrRequestFacebook=$.ajax({url:n,dataType:"json",type:"GET",data:JSON.stringify({}),contentType:"application/json; charset=utf-8","async":!0,error:function(n){xhrRequestFacebook&&xhrRequestFacebook.readyState!=4?xhrRequestFacebook.abort():(Face_Error_API(100,n.responseJSON!=undefined?n.responseJSON.error.message:""),Face_SH_Click_Error())},success:function(n){let t={};if(t.permalink_url=n.permalink_url,t.created_time=n.created_time,n.from!=undefined?(t.from_id=n.from.id,t.from_name=n.from.name):(t.from_id="",t.from_name=""),t.message=n.message,t.is_hidden=n.is_hidden,t.like_count=n.like_count,n.hasOwnProperty("attachment")){t.type=n.attachment.type;switch(n.attachment.type){case"animated_image_share":case"photo":case"sticker":t.url=n.attachment.media.image.src;break;default:t.url=""}}else t.type="",t.url="";if(t.id=n.id,face_data_comment.push(t),n.hasOwnProperty("comments")){let t=n.comments.data;if(t!=undefined&&t.length!=0)for(k=0;k<t.length;k++){let n={};if(n.permalink_url=t[k].permalink_url,n.created_time=t[k].created_time,n.from_id=t[k].from.id,n.from_name=t[k].from.name,n.message=t[k].message,n.is_hidden=t[k].is_hidden,n.like_count=t[k].like_count,t[k].hasOwnProperty("attachment")){n.type=t[k].attachment.type;switch(t[k].attachment.type){case"animated_image_share":case"photo":case"sticker":n.url=t[k].attachment.media.image.src;break;default:n.url=""}}else n.type="",n.url="";n.id=t[k].id;face_data_comment.push(n)}}Face_Render_API_Comment(face_data_comment,"MessengerArea_Messenger_Content_Area")}})}}function Face_Render_API_Post(n,t){var i=document.getElementById(t);if(face_value_current_post_link="#",i!=null){i.innerHTML="";let r="";if(n&&n.length>0){let t=ConvertDateTimeUTC_Time(n[0].created_time);face_value_current_post_link=n[0].permalink_url;let i="//graph.facebook.com/"+n[0].from_id+"/picture?access_token="+Face_Get_Token_Access_From_PageID(face_value_current_page);r='<div class="postDetail_me"><div class="divPostInMessage">'+(n[0].full_picture==""?"":'<img class="image_me" src="'+n[0].full_picture+'" alt="label-image" />')+(n[0].message==""?"":'<span class="postmessage_me" title="'+t+'">'+n[0].message+"<\/span>")+'<div class="postmessage_me postmessage_me_name"><img style="margin-bottom: 4px;display: inline;" class="ui mini circular image pageAvatarsmall" src="'+i+'" alt="label-image" />'+n[0].from_name+'<br><a href="'+n[0].permalink_url+'" target="_blank"><img style="height: 16px;margin-right: 10px;margin-left: -1px;margin-bottom: -4px;" title="Link comment" src="/assests/img/Face/face_icon.png"><\/a>'+t+"<\/div><\/div><\/div>"}document.getElementById(t).innerHTML=r}}function Face_Render_API_Comment(n,t){var r=document.getElementById(t);if(r!=null){r.innerHTML="";let u="";if(n&&n.length>0)for(i=0;i<n.length;i++){let t=n[i],r=Face_Render_API_Comments_Each(t,i==0?1:0),f=Face_Render_API_Comments_Time(t.from_id,t.created_time);u=u+r+f}document.getElementById(t).innerHTML=u}Face_Comment_Click_Hidden();Face_Comment_Click_Delete();Face_Comment_Click_Edit();Face_ScrollContentTo_First_Last();Face_Image_Chating_Click();Face_Event_Show_Title()}function Face_Render_API_Comments_Time(n,t){let i="",r=ConvertDateTimeUTC_Time_DOWFULLDAY(t);return i=face_value_current_page!=n?n==""?"/assests/img/Face/loading_avatar.gif":"//graph.facebook.com/"+n+"/picture?access_token="+Face_Get_Token_Access_From_PageID(face_value_current_page):face_link_image_fanpage.replace("{keycode}",n),face_value_current_page!=n?'<div style="display: flow-root;padding-bottom: 3px; padding-left: 17px;"><img style="display: inline;" class="ui mini circular image pageAvatarsmall" src="'+i+'" alt="label-image" /><span style="font-size: 12px;">'+r+"<\/span><\/div><\/br><\/br>":'<div style="display: flow-root;padding-bottom: 3px;padding-right: 11px;float: right;"><span style="font-size: 12px;padding-right: 10px;">'+r+'<\/span><img style="margin-bottom: 5px;float: right;" class="ui mini circular image pageAvatarsmall" src="'+i+'" alt="label-image" /><\/div><\/br><\/br>'}function Face_Render_API_Comments_Each(n,t){let s=ConvertDateTimeToTimeSpan(n.created_time),r=n.is_hidden,h=n.message,i=n.id,l=n.type,u=n.url,f=n.permalink_url,c=ConvertDateTimeUTC_Time_DOWFULLDAY(n.created_time),o="",e="";return n.from_id==face_value_current_page?(e=r?"message_me me_hidden __comment_me_face_":"message_me __comment_me_face_",o='<div id="'+s+'" class="messengerDetail_me" ><div id="com_div_'+i+'" class="'+e+'" title="'+c+'"><span id="com_'+i+'">'+h+"<\/span>"+(u==""?"":'<img class="sticker_me_comment"  src="'+u+'">')+'<span class="comment_button_div"><a class="commentedit_a" href="#"  id="edit_'+i+'"><img id="imgEdit_'+i+'" class="commentdelete commentdelete_img" src="/assests/img/Face/edit.png"><\/a><a class="commentdelete_a" href="#" data_first="'+t+'"  id="del_'+i+'"><img id="imgDelete_'+i+'" class="commentdelete commentdelete_img" src="/assests/img/Face/nodelete_w.png"><\/a>'+(f!=""?'<a href="'+f+'" target="_blank"><img class="commentdelete commentdelete_img"  title="Link comment" src="/assests/img/Face/face_w.png"><\/a>':"")+"<\/span><\/div><\/div>"):(e=r?"message_client client_hidden __comment_client_face_":"message_client __comment_client_face_",o='<div id="'+s+'" class="messengerDetail_client"><div id="com_div_'+i+'" class="'+e+'" title="'+c+'"><span id="com_'+i+'">'+h+"<\/span>"+(u==""?"":'<img class="sticker_client_comment"  src="'+u+'">')+'<span class="comment_button_div"><a class="commentdelete_a" href="#" data_first="'+t+'"  id="del_'+i+'"><img id="imgDelete_'+i+'" class="commentdelete commentdelete_img" src="/assests/img/Face/nodelete_b.png"><\/a>'+(f!=""?'<a href="'+f+'" target="_blank"><img class="commentdelete commentdelete_img"  title="Link comment" src="/assests/img/Face/face_b.png"><\/a>':"")+'<a class="commenthidden" title="'+(r?"Unhide":"Hide")+'" id="hidcom_'+i+'" href="#"><img id="imghidcom_'+i+'" class="commentdelete commentdelete_img" src="'+(r?"/assests/img/Face/nohide.png":"/assests/img/Face/hide.png")+'"><\/a><\/span><\/div><\/div>'),o}function Face_Comment_Click_Hidden(){$(".commenthidden").click(function(){let n,t=this.id,i=t.replace("hidcom_",""),r="imghidcom_"+i,f="com_div_"+i;n=this.title=="Unhide"?!1:!0;let u=facebook_link_executecomment.replace("{version}",facebook_version);u=u.replace("{comment_id}",i);$.ajax({url:u,dataType:"json",type:"POST",contentType:"application/json",data:JSON.stringify({is_hidden:n,access_token:Face_Get_Token_Access_From_PageID(face_value_current_page)}),contentType:"application/json; charset=utf-8","async":!0,error:function(){Face_Error_API(1,"Cannot hide or unhide this comment")},success:function(i){i!=null&&i!=undefined&&i.success&&i.success&&(n==!1?($("#"+f).removeClass("client_hidden"),$("#"+t)[0].title="Hide",$("#"+r).attr("src","/assests/img/Face/hide.png")):($("#"+f).addClass("client_hidden"),$("#"+t)[0].title="Unhide",$("#"+r).attr("src","/assests/img/Face/nohide.png")))},beforeSend:function(){$("#"+r).attr("src","/assests/img/Face/waiting_exe.gif")}})})}function Face_Comment_Click_Delete(){$(".commentdelete_a").click(function(){const n=notiConfirm();let t=this.id,i=$(this).attr("data_first");n.then(function(){Face_Comment_Click_Delete_Confirm(t,i)},function(){})})}function Face_Comment_Click_Delete_Confirm(n,t){let u=n.replace("del_",""),i="imgDelete_"+u,r=facebook_link_executecomment.replace("{version}",facebook_version);r=r.replace("{comment_id}",u);$.ajax({url:r,dataType:"json",type:"DELETE",contentType:"application/json",data:JSON.stringify({access_token:Face_Get_Token_Access_From_PageID(face_value_current_page)}),contentType:"application/json; charset=utf-8","async":!0,error:function(){Face_Error_API(1,"Cannot delete this comment")},success:function(n){n!=null&&n!=undefined&&n.success&&n.success&&($("#"+i).attr("src","/assests/img/Face/deleted.png"),$("#"+i).closest(".message_me").css("background-color","#07283e"),$("#"+i).closest(".commentdelete_a").unbind("click"),t=="1")},beforeSend:function(){$("#"+i).attr("src","/assests/img/Face/waiting_exe.gif")}})}function Face_DeleteComment_ToDB(n){AjaxLoad(url="/Facebook/Messenger/?handler=Delete_First_Comment",data={comment:face_selected_commentid,post:face_selected_postid},async=!0,error=null,success=function(){$("#deletehind_"+n).show()})}function Face_Comment_Click_Edit(){$(".commentedit_a").click(function(){let i=this.id,n=i.replace("edit_","");face_value_current_comment_edit=n;let t="com_"+n,r=document.getElementById(t).childNodes[0]!=undefined?document.getElementById(t).childNodes[0].textContent:"";$("#MessengerArea_Chating_Hide").css("display")=="none"&&($("#MessengerArea_Chating_Edit").css("display")=="none"?($("#MessengerArea_Chating_Edit").show(),$("#MessengerArea_Chating").hide(),$("#txtContentMessage_Chatting_Edit").val(r)):($("#MessengerArea_Chating_Edit").hide(),$("#MessengerArea_Chating").show(),$("#txtContentMessage_Chatting_Edit").val("")));$("#imgEdit_"+face_value_current_comment_edit).attr("src","/assests/img/Face/waiting_exe.gif")})}function Face_Comment_Click_Edit_OK(){let t=$("#txtContentMessage_Chatting_Edit").val(),n=facebook_link_executecomment.replace("{version}",facebook_version);n=n.replace("{comment_id}",face_value_current_comment_edit);let i="com_"+face_value_current_comment_edit;$.ajax({url:n,dataType:"json",type:"POST",contentType:"application/json",data:JSON.stringify({message:t,access_token:Face_Get_Token_Access_From_PageID(face_value_current_page)}),contentType:"application/json; charset=utf-8","async":!0,error:function(){notiError("Cannot edit this comment. Try again later")},success:function(n){n!=null&&n!=undefined&&n.success&&n.success&&($("#MessengerArea_Chating_Edit").hide(),$("#MessengerArea_Chating").show(),$("#txtContentMessage_Chatting_Edit").val(""),$("#imgEdit_"+face_value_current_comment_edit).attr("src","/assests/img/Face/edit.png"),face_value_current_comment_edit="",document.getElementById(i).childNodes[0].textContent=t)}})}function Face_Comment_Click_Edit_Cancel(){$("#MessengerArea_Chating_Edit").hide();$("#MessengerArea_Chating").show();$("#txtContentMessage_Chatting_Edit").val("");$("#imgEdit_"+face_value_current_comment_edit).attr("src","/assests/img/Face/edit.png");face_value_current_comment_edit=""}function Face_API_Send_COMMENT_Text(){let n=$("#txtContentMessage_Chatting").val().trim();if($("#txtContentMessage_Chatting").val(""),n!=""&&face_value_current_comment!=""){let i=(new Date).getTime();Face_Send_Temporary_Comment_Text(n,i,"MessengerArea_Messenger");let t=facebook_link_send_comment;t=t.replace("{comment_id}",face_value_current_comment).replace("{version}",facebook_version);$.ajax({url:t,dataType:"json",type:"POST",contentType:"application/json",data:JSON.stringify({message:n,access_token:Face_Get_Token_Access_From_PageID(face_value_current_page)}),contentType:"application/json; charset=utf-8","async":!0,error:function(n){n.responseJSON.error.code==10?Face_Error_API(10,n.responseJSON!=undefined?n.responseJSON.error.message:""):Face_Error_API(1,n.responseJSON!=undefined?n.responseJSON.error.message:"")},success:function(t){if(t!=null&&t!=undefined)if(t.id!=undefined&&t.id!=null){let r=t.id;Face_API_Get_Comment_Detail(r,i);Face_Send_Comment_Sucessful(face_value_current_conver_id,face_value_current_page,n)}else notiError("Error Comment")}})}}function Face_Send_Temporary_Comment_Text(n,t,r){var u=document.getElementById(r).children,f=document.getElementById(r),e;if(u!=undefined){let r="";if(n!=undefined&&n){let i="";i='<div id="'+t+'"  class="messengerDetail_me">'+(n==""?"":'<span class="message_me message_me_temp" ><img class="waitingfacebook_exe" src="/assests/img/Face/waiting_exe.gif" alt="label-image" />'+n+"<\/span>")+"<\/div>";r=i}if(r!=""){let o=t!=""?Number(t):0,n=0;for(i=u.length-1;i>=0;i--){let t=u[i].id;o>t&&(n=i,i=0)}e=createElementFromHTML(r);n==u.length-1?f.appendChild(e):f.insertBefore(e,f[n-1])}}Face_ScrollContentTo_First_Last()}function Face_API_Get_Comment_Detail(n,t){$.ajax({url:facebook_link_comment_detail.replace("{comment_id}",n).replace("{version}",facebook_version)+"&access_token="+Face_Get_Token_Access_From_PageID(face_value_current_page),dataType:"json",type:"GET",data:JSON.stringify({}),contentType:"application/json; charset=utf-8","async":!0,error:function(){},success:function(n){let t={};t.permalink_url=n.permalink_url;t.created_time=n.created_time;t.from_id=n.from.id;t.from_name=n.from.name;t.message=n.message;t.is_hidden=n.is_hidden;t.like_count=n.like_count;t.type="";t.url="";t.id=n.id;face_data_comment.push(t);let r=Face_Render_API_Comments_Time(n.from.id,n.created_time),i=document.getElementById("MessengerArea_Messenger").innerHTML;i=i+Face_Render_API_Comments_Each(t)+r;document.getElementById("MessengerArea_Messenger").innerHTML=i},complete:function(){$("#"+Number(t)).length&&$("#"+Number(t)).remove();Face_Comment_Click_Hidden();Face_Comment_Click_Delete();Face_Comment_Click_Edit();Face_ScrollContentTo_First_Last();Face_Image_Chating_Click();Face_Event_Show_Title()}})}function Face_Goto_FacePost_Link(){face_value_current_mess_post=="COM"&&window.open(face_value_current_post_link)}function Face_Goto_MESSAGE_From_Post(){let n=face_value_current_page+"-"+face_value_current_client;$("#"+n).length?(Face_Exchange_Move_Mess_To_Top(n,face_value_current_page,face_value_current_client),Face_Event_Conversation_List_Click(),Face_Trigger_Click(n)):AjaxLoad(url="/Facebook/Messenger/?handler=Face_Checking_Mess_Is_Exist",data={page:face_value_current_page,client:face_value_current_client},async=!0,error=function(){Face_Create_New_Obj_Mess_Empty_From_Comment()},success=function(n){if(n!="0"){let t=JSON.parse(n);if(t.length==0)Face_Create_New_Obj_Mess_Empty_From_Comment();else{let n=Face_Create_New_Obj_FromData(t[0]);Face_Exchange_Create_Mess_To_Top(n.id,n.e);Face_Event_Conversation_List_Click();Face_Trigger_Click(n.id)}}else Face_Create_New_Obj_Mess_Empty_From_Comment()});$("#MessengerArea_Reply_Comment").show();face_is_send_mess_from_comment=1}