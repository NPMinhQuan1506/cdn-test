async function APIAccount_ExcutedEach(n,t="",i="save"){return new Promise(r=>{let e=apia_mapping(APIAccount_dataSetting)(n),{objResult:u,dataVoucher:f}=e;if(typeof u!="undefined"&&typeof f!="undefined"&&Object.keys(u).length>0){let e=0,o=0,s=0,h="";e=n[0].BranchID;o=n[0].CustID;s=n[0].IsUpdate;h=t==""?n[0].Code:t;AjaxJWT(url="/api/Accounting/Excuted",data=JSON.stringify({para:JSON.stringify(u),dataVoucher:JSON.stringify(f),page:apia_getpath(),branchid:e,custid:o,topic:h,action:i,isupdate:s}),async=!0,success=function(n){r(n)})}else typeof failurefunc=="function"&&failurefunc()})}async function APIAccount_Excute(n,t,i="save",r,u,f,e){typeof r=="function"&&r();new Promise(r=>{setTimeout(()=>{typeof syn_Accountbrand!="undefined"&&syn_Accountbrand&&syn_Accountbrand!=""&&AjaxJWT(url="/api/Accounting/LoadData",data=JSON.stringify({currentID:n,type:t,action:i}),async=!0,success=function(n){if(n!="0"){let t=JSON.parse(n);APIAccount_dataSetting=t.DataSetting;let r=t.DataMain;APIAccount_ExcutedEach(r,topic="",i).then(n=>{n=="1"?typeof u=="function"&&u():typeof f=="function"&&f()})}else typeof f=="function"&&f();r();typeof e=="function"&&e()})},100)})}async function APIAccount_ExcuteMulti(n,t="save",i,r,u,f){typeof i=="function"&&i();new Promise(i=>{setTimeout(()=>{typeof syn_Accountbrand!="undefined"&&syn_Accountbrand&&syn_Accountbrand!=""&&AjaxJWT(url="/api/Accounting/LoadDataMulti",n=JSON.stringify({data:n}),async=!0,success=function(n){if(n!="0"){let f=JSON.parse(n),{DataSetting:o,...dataMains}=f;APIAccount_dataSetting=o;let i=Object.keys(dataMains),e=[],s=new Date,h=`SyncMulti_${ConvertDateTimeUTC_YMD(s)}`;if(dataMains&&i.length>0){for(let n=0;n<i.length;n++){let r=i[n],u=dataMains[r];e.push(APIAccount_ExcutedEach(u,h,t))}Promise.all(e).then(()=>{});typeof r=="function"&&r()}else typeof u=="function"&&u();let c=f.DataMain}else typeof u=="function"&&u();i();typeof f=="function"&&f()})},100)})}function APIAccount_getVoucherType(n,t){let i=0;switch(n){case 1:i=t==1?1:2;break;case 2:i=t==1?3:4;break;case 3:i=t==1?5:6;break;case 4:i=7;break;case 5:i=9;break;case 6:i=10;break;case 9:i=8}return i}var APIAccount_dataSetting=[];