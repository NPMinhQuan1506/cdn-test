async function exportToExcel(n,t){return new Promise(async i=>{typeof toastExportExcel=="object"&&toastExportExcel.begin();try{$("#tablePrintForAll").empty();let e=$("#"+n).clone(),s=n+"Copy";e.attr("id",s);$("#tablePrintForAll").html(e);let h=document.getElementById(s).rows,o=e[0].querySelector("thead")?e[0].querySelector("thead").rows.length:1,c=new Map,l=new ExcelJS.Workbook,u=l.addWorksheet("Sheet1"),r=1;for(let n=0;n<h.length;n++){let i=h[n],t=1,f=[];if(Array.from(i.cells).forEach((n,t)=>{(n.style.display==="none"||n.classList.contains("d-none")||$(n).css("display")==="none")&&f.push(t)}),f.reverse().forEach(n=>i.deleteCell(n)),i.id&&getComputedStyle(i).display==="none"){i.remove();n--;continue}for(let f=0;f<i.cells.length;f++){let e=i.cells[f],a=`${r}-${t}`,v=$(e).find(".selection.dropdown .text").text().replace(/\s+/g," ")||e.innerText.trim().replace(/\s+/g," ");while(c.has(a))t++,a=`${r}-${t}`;let s=u.getCell(r,t);s.value=$(e).hasClass("vt-number-order")&&n>=o?r-o:v;export_formatValue(s);s.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}};Export_renderStyle(isHeader=n<o,e,s);let l=parseInt(e.getAttribute("rowspan"))||1,h=parseInt(e.getAttribute("colspan"))||1;if(l>1||h>1){u.mergeCells(r,t,r+l-1,t+h-1);for(let n=0;n<l;n++)for(let i=0;i<h;i++)c.set(`${r+n}-${t+i}`,!0)}t=t+h}r++}let a=u.columns;a.forEach((n,t)=>{let i=Object.values(n.values),r=Math.max(...i.map(n=>n.toString().length))||20;n.width=Math.max(10,r+5);let f=u.getRow(2).getCell(t+1)});u.properties.defaultRowHeight=20;t=SysDate().FNOW().UTC_DNum().toString()+"-"+(t?decodeHtml(t):"VTtech-Excel");let v=await l.xlsx.writeBuffer(),y=new Blob([v],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),p=window.URL.createObjectURL(y),f=document.createElement("a");f.href=p;f.download=`${t||"Export"}.xlsx`;document.body.appendChild(f);f.click();document.body.removeChild(f);$("#tablePrintForAll").empty();typeof toastExportExcel=="object"&&toastExportExcel.complete();i()}catch(r){i(r);typeof toastExportExcel=="object"&&toastExportExcel.error()}})}function Export_renderStyle(n,t,i){if(t!=null&&i!=null)if(n)i.fill={type:"pattern",pattern:"solid",fgColor:{argb:expExcel_bgColor}},i.font={color:{argb:expExcel_fontColor},bold:!0,size:12},i.alignment={vertical:"middle",horizontal:"center",wrapText:"normal"};else{const n=getComputedStyle(t),r=n.verticalAlign||"middle",u=n.textAlign||"center",f=export_getCellBackgroundColor(t),e=n.color||"black",h=n.fontSize||"10pt",o=n.fontWeight||"normal",s=n.fontStyle||"normal";i.alignment={vertical:r,horizontal:u,wrapText:n.whiteSpace==="normal"};i.fill={type:"pattern",pattern:"solid",fgColor:{argb:rgb2hex(f).replace("#","")}};i.font={color:{argb:rgb2hex(e).replace("#","")},bold:o==="bold",italic:s==="italic"}}}function export_getCellBackgroundColor(n){const r=getComputedStyle(n),u=getComputedStyle(n.parentElement),t=r.backgroundColor;if(t!=="rgba(0, 0, 0, 0)"&&t!=="transparent")return t;const i=u.backgroundColor;return i!=="rgba(0, 0, 0, 0)"&&i!=="transparent"?i:"white"}function exportToExcel_Xls(n,t){var h,u,f,r,i,l,o;$("#tablePrintForAll").empty();h=document.getElementById(n).tBodies[0].id;u=$("#"+n).clone();let e=n+"Copy",a=h+"Copy";u.attr("id",e);$("#tablePrintForAll").html(u);document.getElementById(e).tBodies[0].id=a;let c=0,s=[];for(u=document.getElementById(e),f=0;r=u.rows[f];f++){for(i=0;l=r.cells[i];i++)if(r.cells[i].nodeName=="TH"){if(r.cells[i].style.display=="none"||r.cells[i].innerHTML=="Sửa"||r.cells[i].innerHTML=="Xóa"||$(r.cells[i]).hasClass("d-none")==!0){let n={};n.NodeName=i;s.push(n)}c=1}if(c===1)break}for(f=0;r=u.rows[f];f++)for(i=u.rows[f].cells.length-1;l=r.cells[i];i--)for(o=0;o<s.length;o++)i==s[o].NodeName&&r.deleteCell(i);$("#"+e+" th").css({"background-color":"#"+expExcel_bgColor,color:"#"+expExcel_fontColor,border:"1px solid #000"});$("#"+e+" td").css({border:"1px solid #000"});$("#"+e).table2excel({exclude:".csv",name:"Worksheet Name",filename:t,fileext:".csv"});$("#tablePrintForAll").empty()}function export_cleanOverlappingMerges(n){if(!Array.isArray(n))return console.error("Input to export_cleanOverlappingMerges is not an array."),[];console.log(`Starting merge cleaning. Input count: ${n.length}`);const t=[],r=new Set,u=(n,t)=>r.has(`${n},${t}`),f=(n,t,i,u)=>{for(let f=n;f<=i;f++)for(let n=t;n<=u;n++)r.add(`${f},${n}`)};let i=0;for(const r of n){if(!r||!r.s||!r.e||typeof r.s.r!="number"||typeof r.s.c!="number"||typeof r.e.r!="number"||typeof r.e.c!="number"){console.warn("Skipping invalid merge object:",r);i++;continue}const{s:n,e:e}=r;let o=!1;const s=Math.min(n.r,e.r),h=Math.min(n.c,e.c),c=Math.max(n.r,e.r),l=Math.max(n.c,e.c);for(let n=s;n<=c;n++){for(let t=h;t<=l;t++)if(u(n,t)){o=!0;break}if(o)break}o?i++:(t.push(r),f(s,h,c,l))}return console.log(`Finished merge cleaning. Cleaned count: ${t.length}. Skipped: ${i}`),t}function export_optimizedMergeCells(n,t){if(!n||typeof n.getCell!="function"||typeof n.mergeCells!="function"){console.error("Invalid worksheet object provided to export_optimizedMergeCells.");return}if(!Array.isArray(t)){console.error("Invalid cleanedMerges array provided to export_optimizedMergeCells.");return}if(t.length===0){console.log("No merges to apply after cleaning.");return}console.log(`Starting optimized merge process for ${t.length} ranges.`);console.time("Optimized Merging");const i=n._mergeCellsInternal;try{n._mergeCellsInternal=function(n,t){const i=this.getCell(n.top,n.left);for(let r=n.top;r<=n.bottom;r++)for(let u=n.left;u<=n.right;u++)if(r>n.top||u>n.left){const n=this.getCell(r,u);n.merge(i,t)}this._merges=this._merges||{};this._merges[i.address]=n};let i=0;for(const{s:r,e:u}of t)r&&typeof r.r=="number"&&typeof r.c=="number"&&u&&typeof u.r=="number"&&typeof u.c=="number"?(n.mergeCells(r.r+1,r.c+1,u.r+1,u.c+1),i++):console.warn("Skipping merge due to invalid coordinates in cleaned data:",{s:r,e:u});console.log(`Applied ${i} merges.`)}catch(r){console.error("Error during optimized merge execution:",r)}finally{i?(n._mergeCellsInternal=i,console.log("Restored original _mergeCellsInternal function.")):console.warn("Could not restore original _mergeCellsInternal function.")}console.timeEnd("Optimized Merging")}async function exportJsonToExcel(n,t,i={},r={}){if(!t||t.length===0){notiWarning("Empty data");toastExportExcel?.close();return}typeof toastExportExcel=="object"&&toastExportExcel.begin();try{let e=new ExcelJS.Workbook,u=e.addWorksheet("Sheet"),c=Object.values(i).map(n=>decodeHtml(typeof n=="object"?n[0]:n));u.addRow(c);let o=[];r?.KeyDetail&&(o=exportJsonToExcel_MergesCell(i,t,r.ColumnSkip,r.KeyDetail),t=exportJsonToExcel_MergesData(t,r.KeyDetail,i));let s=-1,h=5e3;for(let n=0;n<t.length;n+=h){let r=t.slice(n,n+h).map(n=>(s++,Object.keys(i).map(t=>{let r=i[t];return typeof r=="object"?exportJsonToExcel_CheckPer(r[2])?typeof r[1]!="function"?n[t]:exportJsonToExcel_CallFunc(r[1],n[t],n,s):"":n[t]})));u.addRows(r)}const l=export_cleanOverlappingMerges(o);u&&typeof u.mergeCells=="function"?export_optimizedMergeCells(u,l):console.error("Cannot perform merge: worksheet is invalid or missing required methods.");u.border={top:{style:"thick"},left:{style:"thick"},bottom:{style:"thick"},right:{style:"thick"}};let a=u.columns;a.forEach((n,t)=>{let r=Object.values(n.values),f=Math.max(...r.map(n=>n?.toString().length))||20;n.width=Math.max(10,f+5);let i=u.getRow(1).getCell(t+1);i.fill={type:"pattern",pattern:"solid",fgColor:{argb:expExcel_bgColor}};i.font={color:{argb:expExcel_fontColor},bold:!0,size:12};i.alignment={vertical:"middle",horizontal:"center",wrapText:"normal"};let e=u.getRow(2).getCell(t+1),o=export_encodeCol(t+1);for(let n=1;n<=u.rowCount;n++){let t=`${o}${n}`;u.getCell(t).border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}export_formatValue(e,t+1,u)});u.properties.defaultRowHeight=20;let v=await e.xlsx.writeBuffer(),y=new Blob([v],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),p=window.URL.createObjectURL(y),f=document.createElement("a");f.href=p;f.download=`${n||"Export"}.xlsx`;document.body.appendChild(f);f.click();document.body.removeChild(f);typeof toastExportExcel=="object"&&toastExportExcel.complete()}catch(u){console.error("Export error: ",u);toastExportExcel?.error()}}function exportJsonToExcel_CallFunc(n,t,i,r){try{return n(t,i,r)}catch{return null}}function exportJsonToExcel_MergesCell(n,t,i,r){try{let u=[],e=exportJsonToExcel_IndexHeader(n,i);if(e.length===0)return u;let f=1;return t.forEach(t=>{let i=t[r]?.length||1;for(let t=0;t<Object.keys(n).length;t++)e.includes(t)||u.push({s:{c:t,r:f},e:{c:t,r:f+i-1}});f+=i}),u}catch{return[]}}function exportJsonToExcel_MergesData(n,t,i){try{return n.flatMap(n=>{let r=n[t]||[];return r.length?r.map((r,u)=>{if(u===0)return{...n,...r};let f={...n,...r};return Object.keys(n).forEach(r=>{r!==t&&(f[r]=exportJsonToExcel_defaultVal(r,n[r],i))}),f}):[n]})}catch{return n}}function exportJsonToExcel_defaultVal(n,t,i){if(i[n]&&typeof i[n][1]=="function")return t;switch(typeof t){case"bigint":return 0n;case"boolean":return!1;case"number":return 0;case"object":return null;default:return""}}function exportJsonToExcel_IndexHeader(n,t){try{return Object.keys(n).map((n,i)=>t.includes(n)?i:-1).filter(n=>n!==-1)}catch{return[]}}function exportJsonToExcel_CheckPer(n){return typeof n!="string"?!0:n.trim()!=""&&PermissionTable_TabControl&&PermissionTable_TabControl[n.trim()]==undefined?!1:!0}function export_getCellValue(n){return n?.richText&&n?.richText.length>0?n.richText.map(n=>n.text).join(""):typeof n?.text!="undefined"?n?.text??"":typeof n?.value!="undefined"?n?.value??"":n??""}function export_formatValue(n,t=null,i=null){let u=t!=null&&i!=null?i.getColumn(t):n,r=n.value;/^\d{1,3}(,\d{3})*(\.\d+)?$/gm.test(r)&&(r=r.toString().replace(/,/g,""));r=isNaN(Number(r))?r:Number(r);n.value!=undefined&&(n.value=r);u.numFmt=typeof r=="number"?r%1!=0?"#,##0.00":"#,##0":r instanceof Date?r.getHours()===0&&r.getMinutes()===0&&r.getSeconds()===0?"dd-mm-yyyy;@":"dd-mm-yyyy hh:mm:ss;@":typeof r=="string"?"@":"General"}function export_encodeCol(n){let t="";while(n>0)n--,t=String.fromCharCode(65+n%26)+t,n=Math.floor(n/26);return t}var expExcel_bgColor="E4E4E4",expExcel_fontColor="141B25";(function(n){async function t(t=""){return new Promise(r=>{var u=["style","link"],f=[];for(let r=0;r<u.length;++r)n(document).find(u[r]).each(function(){u[r]=="style"&&(t+="\n"+n(this)[0].innerHTML+"\n");(u[r]=="link"||n(this).attr("rel")=="stylesheet"&&proto.test(n(this).attr("href")))&&f.push(i(n(this).attr("href")))});f&&f.length!=0?Promise.all(f).then(n=>{if(n&&n.length)for(let i=0;i<n.length;i++)t+="\n"+n[i]+"\n";r(t)}).catch(()=>{r(t)}):r(t)})}async function i(t){return new Promise(i=>{t&&t!=""&&n.get(t,function(n){i(n)})})}n.fn.wordExport=async function(i,r){var o,s,e,f,h,u;i=typeof i!="undefined"?i:"jQuery-Word-Export";o={mhtml:{top:"Mime-Version: 1.0\nContent-Base: "+location.href+'\nContent-Type: Multipart/related; boundary="NEXT.ITEM-BOUNDARY";type="text/html"\n\n--NEXT.ITEM-BOUNDARY\nContent-Type: text/html; charset="utf-8"\nContent-Location: '+location.href+"\n\n<!DOCTYPE html>\n<html>\n_html_<\/html>",head:'<head>\n<meta http-equiv="Content-Type" content="text/html; charset=utf-8">\n<style>\n_styles_\n<\/style>\n<\/head>\n',body:"<body>_body_<\/body>"}};r={maxWidth:624};s=n(this).clone();s.each(function(){var t=n(this);t.is(":hidden")&&t.remove()});e=Array();f="\n";for(let n=0;n<e.length;n++)f+="--NEXT.ITEM-BOUNDARY\n",f+="Content-Location: "+e[n].location+"\n",f+="Content-Type: "+e[n].type+"\n",f+="Content-Transfer-Encoding: "+e[n].encoding+"\n\n",f+=e[n].data+"\n\n";f+="--NEXT.ITEM-BOUNDARY--";h="@page WordSection1{size: 841.95pt 595.35pt;mso-page-orientation: landscape;}div.WordSection1 {page: WordSection1;}table{border-collapse:collapse;}td{border:1px gray solid;width:5em;padding:2px;}";css="@page WordSection1{size: 841.95pt 595.35pt;mso-page-orientation: landscape;}table{page: WordSection1;}";u="";u=u+"@page WordSection1{size: 841.95pt 595.35pt;mso-page-orientation: landscape;}";u=u+"table {width: 100%;font: 17px Calibri;page: WordSection1;}";u=u+"table, th, td {border: solid 1px #DDD; border-collapse: collapse;";u=u+"padding: 2px 3px;text-align: center;}";u=u+".fs-5{font-size: 50px;}";t().then(n=>{if(n&&n.length!=0){h+=n;var t=["﻿",o.mhtml.top.replace("_html_",o.mhtml.head.replace("_styles_",h)+o.mhtml.body.replace("_body_",s.html()))+f],r=new Blob(t,{type:"application/msword;charset=utf-8"});saveAs(r,i+".doc")}}).catch(()=>{})}})(jQuery),function(n){n.fn.googoose=function(t,i){var r=this,u=(new Date).getTime(),f=new RegExp(/^(http|https|file):/),e=new RegExp(/^\//),t;r.finish=function(){if(t.debug&&r.debug_fn("finish action"),i){var n=new Blob([t.html],{type:"application/msword"});i(null,n)}else r.saveHtmlAsFile(t.filename,t.html)};t=n.extend({area:"div.googoose-wrapper",margins:"1.0in",zoom:"75",filename:"Doc1_"+u+".doc",size:"8.5in 11.0in",display:"Print",lang:"en-US",toc:"div.googoose.toc",pagebreak:"div.googoose.break",headerarea:"div.googoose.header",footerarea:"div.googoose.footer",headerid:"googoose-header",footerid:"googoose-footer",headermargin:".5in",footermargin:".5in",currentpage:"span.googoose.currentpage",totalpage:"span.googoose.totalpage",finishaction:r.finish,html:null,initobj:document,debugtype:"alert",debug:0},t);r.options=t;r.debug_fn=function(n){t.debugtype=="console"?console.log(n):alert(n)};r.saveHtmlAsFile=function(n,t){var r=navigator.userAgent.match(/MSIE\s([\d.]+)/),e=navigator.userAgent.match(/Trident\/7.0/)&&navigator.userAgent.match(/rv:11/),o=navigator.userAgent.match(/Edge/g),f=r?r[1]:e?11:o?12:-1,u,i;if(r&&f<10){console.log("No blobs on IE ver<10");return}u=new Blob([t],{type:"application/msword"});f>-1?window.navigator.msSaveBlob(u,n):(i=document.createElement("a"),i.download=n,i.href=window.URL.createObjectURL(u),i.onclick=function(n){document.body.removeChild(n.target)},i.style.display="none",document.body.appendChild(i),i.click())};r.decodeHtmlEntity=function(n){return n.replace(/&#(\d+);/g,function(n,t){return String.fromCharCode(t)})};r.translate_mso_features=function(n){return t.debug&&r.debug_fn("GG.translate_mso_features"),n=r.decodeHtmlEntity(n),n=r.remove_bad_tags(n),n=r.convert_pagebreaks(n),n=r.convert_toc(n),n=r.convert_hdrftr(n),r.convert_imgs(n)};r.remove_bad_tags=function(i){t.debug&&r.debug_fn("GG.remove_bad_tags");var u=n(i);return u.find("noscript").each(function(){n(this).replaceWith("")}),u.each(function(){n(this).is(":hidden")&&n(this).remove()}),u[0].outerHTML};r.convert_pagebreaks=function(i){if(t.debug&&r.debug_fn("GG.convert_pagebreaks"),t.pagebreak){var u=n(i);u.find(t.pagebreak).replaceWith(r.get_pagebreak());i=u[0].outerHTML}return i};r.convert_toc=function(i){if(t.debug&&r.debug_fn("GG.convert_toc"),t.toc&&n(t.toc).length){var u=n(i);u.find(t.toc).replaceWith(r.get_toc_contents());i=u[0].outerHTML}return i};r.convert_hdrftr=function(i){var f,e,u;return t.debug&&r.debug_fn("GG.convert_hdrftr"),f=t.headerarea&&n(t.headerarea).length,e=t.footerarea&&n(t.footerarea).length,(f||e)&&(i=r.convert_totalpage(i),i=r.convert_currentpage(i)),u=n(i),f&&(u.find(t.headerarea).replaceWith(r.headerstart()+u.find(t.headerarea).html()+r.headerend()),i=u[0].outerHTML),e&&(u.find(t.footerarea).replaceWith(r.footerstart()+u.find(t.footerarea).html()+r.footerend()),i=u[0].outerHTML),i};r.convert_imgs=function(i){t.debug&&r.debug_fn("GG.convert_imgs");var u=n(i);return imgs=u.find("img"),imgs.each(function(){var t=n(this)[0].src,i=window.location,r=i.protocol+"//demo.vttechsolution.com/",u;f.test(t)||(e.test(t)?t=r+t:(u=i.path.replace("//[^/.]+$/","/"),t=r+u+t));n(this).attr("src",t)}),u[0].outerHTML};r.convert_totalpage=function(i){if(t.debug&&r.debug_fn("GG.convert_totalpage"),t.totalpage&&n(t.totalpage).length){var u=n(i);u.find(t.totalpage).html("");u.find(t.totalpage).append(r.get_total_page_number());i=u[0].outerHTML}return i};r.convert_currentpage=function(i){if(t.debug&&r.debug_fn("GG.convert_currentpage"),t.currentpage&&n(t.currentpage).length){var u=n(i);u.find(t.currentpage).html("");u.find(t.currentpage).append(r.get_page_number());i=u[0].outerHTML}return i};r.get_pagebreak=function(){return t.debug&&r.debug_fn("GG.get_pagebreak"),"<br clear=all style='mso-special-character:line-break;page-break-before:always'>"};r.headerstart=function(){var n="";return n+="\n<div style='mso-element:header' id="+t.headerid+">\n",n+'<p class="MsoHeader">\n'};r.headerend=function(){return t.debug&&r.debug_fn("GG.headerend"),"<\/p><\/div>\n"};r.footerstart=function(){t.debug&&r.debug_fn("GG.footerstart");return""+("<div style='mso-element:footer' id="+t.footerid+">")};r.footerend=function(){return t.debug&&r.debug_fn("GG.footerend"),"<\/div>\n"};r.get_page_number=function(){t.debug&&r.debug_fn("GG.get_page_number");var n="<!--[if supportFields]><span\n";return n+="class=MsoPageNumber><span style='mso-element:field-begin'><\/span><span\n",n+="style='mso-spacerun:yes'> <\/span>PAGE <span style='mso-element:field-separator'><\/span><\/span><![endif]--><span\n",n+="class=MsoPageNumber><span style='mso-no-proof:yes'>1<\/span><\/span><!--[if supportFields]><span\n",n+"class=MsoPageNumber><span style='mso-element:field-end'><\/span><\/span><![endif]-->"};r.get_total_page_number=function(){t.debug&&r.debug_fn("GG.get_total_page_number");var n="<!--[if supportFields]><span class=MsoPageNumber><span \n";return n+=" style='mso-element:field-begin'><\/span> NUMPAGES <span style='mso-element:field-separator'><\/span><\/span><![endif]--><span \n",n+=" class=MsoPageNumber><span style='mso-no-proof:yes'>1<\/span><\/span><!--[if supportFields]><span \n",n+" class=MsoPageNumber><span style='mso-element:field-end'><\/span><\/span><![endif]-->\n"};r.get_toc_contents=function(){t.debug&&r.debug_fn("GG.get_toc_contents");var n="<p class=MsoToc1>\n";return n+="<!--[if supportFields]>\n",n+="<span style='mso-element:field-begin'><\/span>\n",n+='TOC o "1-3" \\u \n',n+="<span style='mso-element:field-separator'><\/span>\n",n+="<![endif]-->\n",n+="<span style='mso-no-proof:yes'>Table of content - Please right-click and choose \"Update fields\".<\/span>\n",n+="<!--[if supportFields]>\n",n+="<span style='mso-element:field-end'><\/span>\n",n+="<![endif]-->\n",n+"<\/p>\n"};r.include_css_getlink=async function(t){return new Promise(i=>{t&&t!=""&&n.get(t,function(n){i(n)})})};r.include_css=async function(){return new Promise(n=>{var u,f,e,i;t.debug&&r.debug_fn("GG.include_css");u=[];for(let n=0;n<document.styleSheets.length;n++){f=document.styleSheets[n];e="cssRules"in f?f.cssRules:f.cssRules;for(let n=0;n<e.length;n++)i=e[n],"cssText"in i?u.push(i.cssText):u.push(i.selectorText+" {\n"+i.style.cssText+"\n}\n")}n("\n<style>\n"+u.join("\n")+"\n<\/style>\n")})};r.html=async function(){var i,u;if(t.debug&&r.debug_fn("GG.html"),!n(t.area).length)return null;i=`<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'>
`;i+="<head>\n";i+="<meta charset='utf-8'\n";i+="<!--[if gte mso 9]>\n";i+="<xml>\n";i+="<w:WordDocument>\n";i+="<w:View>"+t.display+"<\/w:View>\n";i+="<w:Zoom>"+t.zoom+"<\/w:Zoom>\n";i+="<w:DoNotOptimizeForBrowser/>\n";i+="<\/w:WordDocument>\n";i+="<o:OfficeDocumentSettings>\n";i+="<o:AllowPNG/>\n";i+="<\/o:OfficeDocumentSettings>\n";i+="<\/xml>\n";i+="<![endif]-->\n";i+="";let f=await r.include_css();return i+=f,i+="<style>\n",i+="#"+t.headerid+", #"+t.footerid+"{\n",i+="\tmargin: 0 0 0 9in;",i+="}\n",i+="<!--\n",i+="@page {\n",i+="\tsize:"+t.size+";\n",i+="\tmargin:"+t.margins+";\n",i+="}\n",i+="@page Container {\n",i+="\tmso-header-margin:"+t.headermargin+";\n",i+="\tmso-footer-margin:"+t.footermargin+";\n",i+="\tmso-header:"+t.headerid+";\n",i+="\tmso-footer:"+t.footerid+";\n",i+="}\n",i+="div.Container { page:Container; }\n",i+="-->\n",i+="<\/style>\n",i+="<\/head>\n",i+='<body lang="'+t.lang+'">\n<div class="Container">',n(t.initobj).is(t.area)?(t.debug&&r.debug_fn("is"),i+=r.translate_mso_features(n(t.initobj)[0].outerHTML)):(t.debug&&r.debug_fn("no is"),n("#tablePrintForAll").empty().show(),u=n(t.initobj).find(t.area).clone(),n("#tablePrintForAll").html(u.outerHTML()),n(t.initobj).find(t.area).each(function(){i+=r.translate_mso_features(n("#tablePrintForAll").outerHTML())}),n("#tablePrintForAll").empty().hide()),i+="<\/div><\/body>\n",i+="<\/html>\n"};setTimeout(()=>{t.debug&&r.debug_fn("googoose exec"),r.html().then(n=>(t.html=n,t.html&&t.finishaction&&t.finishaction(),r))},100)}}(jQuery);let val=$(table.rows[i].cells[j]).html().toString().replace(/[^a-zA-Z0-9\.\-]/gm,"");if(/^(\d+\.?\d*|\.\d+)$/.test(val)){$(table.rows[i].cells[j]).html(Number(val));let n="A".charCodeAt(0),t=String.fromCharCode(n+j);CellNameTypeNumber.push(t+(i+1))}