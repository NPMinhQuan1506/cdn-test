function Work_Scheduler_Get_From_TokenDoc(n,t,r,u,f,e,o){let h=Work_Scheduler_GetArrayTimeLineAllEmployee(u),s=Work_Scheduler_GetArrayTimeLineAllEmployee(f),l=t,a=r,v=o.length,c=[];for(let t=0;t<v;t++){let r=Number(o[t].EmpID);for(let t=l;t<=a;t=t.addDays(1)){let f=SysDate().FUTC(new Date(t.getTime())).UTC_Date(),u=[],o=!1;for(i=0;i<s.length;i++)f.getTime()==SysDate().FUTC(s[i].Date).UTC_Date().getTime()&&r==s[i].EmployeeID&&(o=!0,u=s[i].workScheduler,i=s.Length);if(o){if(u.length==1){let o=u[0].off;if(o){let n={};n.EmpID=r;n.Date_From=f;n.Date_To=f.addHours(23);n.BranchID=0;n.Color="";n.ShiftCode="";n.IsWork=0;n.Date=ConvertDT_To_StringYMD_Int(f);c.push(n)}else{let o=u[0].shift;for(i=0;i<o.length;i++)if(n==0||o[i].branch==n){let n=Work_Scheduler_GetShiftDetail(e,o[i].shift);if(n!=undefined&&n!="[]")for(j=0;j<n.length;j++){let u={},e=n[j].HourFrom,h=Number(e.split(":")[0]),l=Number(e.split(":")[1]),s=n[j].HourTo,a=Number(s.split(":")[0]),v=Number(s.split(":")[1]);u.EmpID=r;u.Date_From=new Date(t.getTime()).addHours(h).addMinutes(l);u.Date_To=new Date(t.getTime()).addHours(a).addMinutes(v);u.BranchID=Number(o[i].branch);u.Color=n[j].ColorCode;u.ShiftCode=n[j].Code;u.IsWork=1;u.Date=ConvertDT_To_StringYMD_Int(f);c.push(u)}}}}}else{for(i=h.length-1;i>=0;i--)f>=SysDate().FUTC(h[i].Date).UTC_Date()&&r==h[i].EmployeeID&&(u=h[i].workScheduler,i=-1);if(u!=null){let s=Number(f.getDay()),o=!1,i=[];for(let n=0;n<u.length;n++)u[n].dayofweek==s.toString()&&(o=u[n].off,i=u[n].shift,n=u.Length);if(i!=[]&&o==!1)for(let u=0;u<i.length;u++)if(n==0||i[u].branch==n||i[u].branch==0){let n=Work_Scheduler_GetShiftDetail(e,i[u].shift);if(n!=undefined&&n!="[]")for(let e=0;e<n.length;e++){let o={},s=n[e].HourFrom,l=Number(s.split(":")[0]),a=Number(s.split(":")[1]),h=n[e].HourTo,v=Number(h.split(":")[0]),y=Number(h.split(":")[1]);o.EmpID=r;o.Date_From=new Date(t.getTime()).addHours(l).addMinutes(a);o.Date_To=new Date(t.getTime()).addHours(v).addMinutes(y);o.BranchID=Number(i[u].branch);o.Color=n[e].ColorCode;o.ShiftCode=n[e].Code;o.IsWork=1;o.Date=ConvertDT_To_StringYMD_Int(f);c.push(o)}}}}}}return c}function Work_Scheduler_GetArrayTimeLineAllEmployee(n){try{let t=[];if(n!=undefined&&n.length!=0){for(let i=0;i<n.length;i++){let r={};r.Date=n[i].Date;r.EmployeeID=n[i].EmpID;r.Note=n[i].Note!=undefined?n[i].Note:"";let u=JSON.parse(n[i].Data),f=[];for(k=0;k<u.length;k++){let n={};n.dayofweek=u[k].dayofweek!=null?u[k].dayofweek:"";n.off=u[k].off;let t=u[k].shift,i=[];for(z=0;z<t.length;z++){let n={};n.shift=t[z].shift;n.branch=t[z].branch;i.push(n)}n.shift=i;f.push(n)}r.workScheduler=f;t.push(r)}return t}return[]}catch(t){return[]}}function Work_Scheduler_GetShiftDetail(n,t){try{let i=[];t=","+t+",";for(let r=0;r<n.length;r++)if(id=n[r].ID,id=","+id+",",t.includes(id)){let t={};t.Code=n[r].Code;t.ColorCode=n[r].ColorCode;t.HourFrom=n[r].HourFrom;t.HourTo=n[r].HourTo;t.ID=n[r].ID;i.push(t)}return i}catch(i){return"[]"}}function Work_Scheduler_Get_From_Employee(n,t,r,u,f,e,o,s){let a=Work_Scheduler_GetArrayTimeLineAllEmployee(f),h=Work_Scheduler_GetArrayTimeLineAllEmployee(e),v=r,y=u,l=[],c="";for(let r=v;r<=y;r=r.addDays(1)){let f=SysDate().FUTC(new Date(r.getTime())).UTC_Date(),u=[],e=!1;for(i=0;i<h.length;i++)f.getTime()==SysDate().FUTC(h[i].Date).UTC_Date().getTime()&&(e=!0,u=h[i].workScheduler,c=h[i].Note,i=h.Length);if(e){if(u.length==1){let e=u[0].off;if(e){let n={};n.EmpID=s;n.Date_From=f;n.Date_To=f.addHours(23);n.BranchID=0;n.Color="";n.IsWork=0;n.Note=c!=undefined?c:"";n.Date=ConvertDT_To_StringYMD_Int(f);l.push(n)}else{let e=u[0].shift;for(i=0;i<e.length;i++)if(n==0||e[i].branch==n){let n=Work_Scheduler_GetShiftDetail(o,e[i].shift);if(n!=undefined&&n!="[]")for(j=0;j<n.length;j++)if(t==0||n[j].ID==t){let t={},u=n[j].HourFrom,h=Number(u.split(":")[0]),a=Number(u.split(":")[1]),o=n[j].HourTo,v=Number(o.split(":")[0]),y=Number(o.split(":")[1]);t.EmpID=s;t.Date_From=new Date(r.getTime()).addHours(h).addMinutes(a);t.Date_To=new Date(r.getTime()).addHours(v).addMinutes(y);t.BranchID=e[i].branch;t.Color=n[j].ColorCode;t.IsWork=1;t.Note=c!=undefined?c:"";t.Date=ConvertDT_To_StringYMD_Int(f);l.push(t)}}}}}else{for(i=a.length-1;i>=0;i--)f>=SysDate().FUTC(a[i].Date).UTC_Date()&&(u=a[i].workScheduler,i=-1);if(u!=null){let h=Number(f.getDay()),e=!1,i=[];for(let n=0;n<u.length;n++)u[n].dayofweek==h.toString()&&(e=u[n].off,i=u[n].shift,n=u.Length);if(i!=[]&&e==!1)for(let u=0;u<i.length;u++)if(n==0||i[u].branch==n||i[u].branch==0){let n=Work_Scheduler_GetShiftDetail(o,i[u].shift);if(n!=undefined&&n!="[]")for(let e=0;e<n.length;e++)if(t==0||n[e].ID==t){let t={},o=n[e].HourFrom,c=Number(o.split(":")[0]),a=Number(o.split(":")[1]),h=n[e].HourTo,v=Number(h.split(":")[0]),y=Number(h.split(":")[1]);t.EmpID=s;t.Date_From=new Date(r.getTime()).addHours(c).addMinutes(a);t.Date_To=new Date(r.getTime()).addHours(v).addMinutes(y);t.Color=n[e].ColorCode;t.IsWork=1;t.Date=ConvertDT_To_StringYMD_Int(f);t.Note="";t.BranchID=i[u].branch;l.push(t)}}}}}return l}