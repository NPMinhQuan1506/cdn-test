function AjaxLoad_XhrIsExist(n){n!=undefined&&n!=""&&Global_AjaxLoad[n]!=undefined&&(Global_AjaxLoad[n].readyState!=4&&Global_AjaxLoad[n].abort(),AjaxLoad_XhrDelete(n))}function AjaxLoad_XhrPush(n,t){n!=undefined&&n!=""&&Global_AjaxLoad[n]==undefined&&(Global_AjaxLoad[n]=t)}function AjaxLoad_XhrDelete(n){n!=undefined&&n!=""&&Global_AjaxLoad[n]!=undefined&&delete Global_AjaxLoad[n]}function AjaxLoad_XhrComplete(){try{if(LocalFlag_TimeOut)return;let i=JSON.parse(localstorage_get("TimeOut")).data;if(i==undefined||i==""||i?.TimeOut==undefined||i?.TimeOut==0)return;var n=new Date,t=new Date(i?.TimeExpired);if(n>t)LocalFlag_TimeOut=!0,AjaxApi(url="/api/Author/Clear",data=JSON.stringify({Islogout:1}),async=!0),AjaxLoad_SessionExpired();else{let u="",t={},r=new Date(n);r.setMinutes(r.getMinutes()+i?.TimeOut);t.TimeOut=i?.TimeOut;t.DateTimeNow=n;t.TimeExpired=r;u=t;localstorage_set("TimeOut",u)}}catch(i){}}function AjaxLoad_DecomJson(n){try{const t=Uint8Array.from(atob(n),n=>n.charCodeAt(0));return pako.inflate(t,{to:"string"})??n}catch(t){return n}}function AjaxLoad_SessionExpired(){Swal.fire({title:`${Outlang.Phien_da_het_han}!`,imageUrl:"/assests/img/image-session-expired.svg",imageWidth:150,width:600,html:decodeHtml(`<span class="text-secondary">${Outlang.Vui_long_dang_nhap_lai}</span>`),allowOutsideClick:!1,confirmButtonText:`${Outlang.Lam_moi}`,customClass:{popup:"shadow shadow-lg",title:"text-dark fs-4",htmlContainer:"mt-0",confirmButton:"btn bg-image-none",image:""}}).then(function(){window.location.replace("/login/login")})}function AjaxLoad(n,t,i,r,u,f,e,o,s){var h=$.ajax({url:n,type:"POST",data:t,contentType:"application/x-www-form-urlencoded","async":i,error:function(){r!=undefined&&r!=null&&r.length!=0&&r()},success:function(t){s==undefined&&AjaxLoad_XhrDelete(n);t!=undefined&&u!=undefined&&u!=null&&u.length!=0&&u(AjaxLoad_DecomJson(t))},beforeSend:function(t){s==undefined&&AjaxLoad_XhrIsExist(n);t.setRequestHeader("XSRF-TOKEN",$('input:hidden[name="__RequestVerificationToken"]').val());e!=undefined&&e!=null&&e.length!=0&&e();f!=undefined&&f!=null&&f.length!=0&&f.css("pointer-events","none")},complete:function(n){o!=undefined&&o!=null&&o.length!=0&&o(n);f!=undefined&&f!=null&&f.length!=0&&f.css("pointer-events","auto");AjaxLoad_XhrComplete()}});return s==undefined&&AjaxLoad_XhrPush(n,h),h}function AjaxJWT(n,t,i,r,u,f,e,o){var s=$.ajax({url:n,type:"POST",data:t,contentType:"application/json; charset=utf-8","async":i,error:function(){f!=undefined&&f!=null&&f.length!=0&&f()},success:function(t){AjaxLoad_XhrDelete(n);t!=undefined&&r!=undefined&&r!=null&&r.length!=0&&r(AjaxLoad_DecomJson(t))},beforeSend:function(t){AjaxLoad_XhrIsExist(n);t.setRequestHeader("Authorization","Bearer "+(localStorage.getItem("WebToken")!=""?localStorage.getItem("WebToken"):getCookie("WebToken")));u!=undefined&&u!=null&&u.length!=0&&u();o!=undefined&&o!=null&&o.length!=0&&o.css("pointer-events","none")},complete:function(n){e!=undefined&&e!=null&&e.length!=0&&e(n);o!=undefined&&o!=null&&o.length!=0&&o.css("pointer-events","auto");AjaxLoad_XhrComplete()}});return AjaxLoad_XhrPush(n,s),s}function AjaxApi(n,t,i,r,u,f){$.ajax({url:n,type:"POST",data:t,contentType:"application/json; charset=utf-8","async":i,success:function(n){n!=undefined&&r!=undefined&&r!=null&&r.length!=0&&r(AjaxLoad_DecomJson(n))},beforeSend:function(){u!=undefined&&u!=null&&u.length!=0&&u()},complete:function(n){f!=undefined&&f!=null&&f.length!=0&&f(n)}})}function AjaxUpload(n,t,i,r,u,f){$("#"+t).unbind("change");$("#"+t).change(function(){let s=document.getElementById(t),e=s.files,o=new FormData;for(let n=0;n!=e.length;n++)o.append("files",e[n]);$.ajax({url:n,data:o,processData:!1,contentType:!1,type:"POST",error:function(){r!=undefined&&r!=null&&r.length!=0&&r()},success:function(n){n!=undefined&&i!=undefined&&i!=null&&i.length!=0&&i(AjaxLoad_DecomJson(n))},beforeSend:function(n){typeof u=="function"&&u();n.setRequestHeader("Authorization","Bearer "+(localStorage.getItem("WebToken")!=""?localStorage.getItem("WebToken"):getCookie("WebToken")))},complete:function(){typeof f=="function"&&f();AjaxLoad_XhrComplete()}})})}function AjaxUpload_Multi(n,t,i,r,u,f,e){$("#"+t).unbind("change");$("#"+t).change(function(){var o=[];let s=document.getElementById(t),f=s.files;if(f.length<=0||f.length>5)e!=undefined&&e!=null&&e();else{for(let t=0;t!=f.length;t++){let e=f[t],h=e.name,a=h.substring(h.lastIndexOf(".")),v=h.substring(0,h.lastIndexOf(".")),y=v.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-zA-Z0-9.\-_]/g,"-").replace(/-+/g,"-").replace(/^-+|-+$/g,"")+a,c=new File([e],y,{type:e.type,lastModified:e.lastModified}),l=new DataTransfer;l.items.add(c);s.files=l.files;o.push(AjaxUpload_MultiExe(n,c,c.name,i,r,u))}Promise.all(o).then(()=>{})}})}function AjaxUpload_MultiExe(n,t,i,r,u,f){return new Promise(e=>{let o=new FormData;o.append("files",t);$.ajax({url:n,data:o,processData:!1,contentType:!1,type:"POST",error:function(){u!=undefined&&u!=null&&u.length!=0&&u(i)},success:function(n){n!=undefined&&r!=undefined&&r!=null&&r.length!=0&&r(AjaxLoad_DecomJson(n),i);e(!0)},beforeSend:function(n){n.setRequestHeader("Authorization","Bearer "+(localStorage.getItem("WebToken")!=""?localStorage.getItem("WebToken"):getCookie("WebToken")));f!=undefined&&f!=null&&f.length!=0&&f(i)},complete:function(){AjaxLoad_XhrComplete()}})})}function AjaxSendEmail(n,t,i,r,u,f,e){return new Promise(()=>{$.ajax({url:n,data:t,processData:!1,contentType:!1,"async":i,type:"POST",error:function(){u!=undefined&&u!=null&&u.length!=0&&u()},success:function(n){n!=undefined&&r!=undefined&&r!=null&&r.length!=0&&r(AjaxLoad_DecomJson(n))},beforeSend:function(n){n.setRequestHeader("Authorization","Bearer "+(localStorage.getItem("WebToken")!=""?localStorage.getItem("WebToken"):getCookie("WebToken")));f!=undefined&&f!=null&&f.length!=0&&f()},complete:function(n){e!=undefined&&e!=null&&e.length!=0&&e(n);AjaxLoad_XhrComplete()}})})}function AjaxSendEmailMulti(n,t,i,r,u,f,e){return new Promise(()=>{$.ajax({url:n,data:t,processData:!1,contentType:!1,"async":i,type:"POST",error:function(){u!=undefined&&u!=null&&u.length!=0&&u()},success:function(n){n!=undefined&&r!=undefined&&r!=null&&r.length!=0&&r(AjaxLoad_DecomJson(n))},beforeSend:function(n){n.setRequestHeader("Authorization","Bearer "+(localStorage.getItem("WebToken")!=""?localStorage.getItem("WebToken"):getCookie("WebToken")));f!=undefined&&f!=null&&f.length!=0&&f()},complete:function(n){e!=undefined&&e!=null&&e.length!=0&&e(n);AjaxLoad_XhrComplete()}})})}function AjaxUpload_Image(n,t){return new Promise(i=>{let f=document.getElementById(t),r=f.files,u=new FormData;for(let n=0;n!=r.length;n++)u.append("files",r[n]);var e=$.ajax({url:n,data:u,processData:!1,contentType:!1,type:"POST",error:function(){i("")},success:function(t){AjaxLoad_XhrDelete(n);t!=undefined&&i(AjaxLoad_DecomJson(t))},beforeSend:function(t){AjaxLoad_XhrIsExist(n);t.setRequestHeader("Authorization","Bearer "+(localStorage.getItem("WebToken")!=""?localStorage.getItem("WebToken"):getCookie("WebToken")))},complete:function(){AjaxLoad_XhrComplete()}});AjaxLoad_XhrPush(n,e)})}function AjaxUpload_ImageByfile(n,t){return new Promise(i=>{let r=new FormData;r.append("files",t);var u=$.ajax({url:n,data:r,processData:!1,contentType:!1,type:"POST",error:function(){i("")},success:function(t){AjaxLoad_XhrDelete(n);t!=undefined&&i(AjaxLoad_DecomJson(t))},beforeSend:function(t){AjaxLoad_XhrIsExist(n);t.setRequestHeader("Authorization","Bearer "+(localStorage.getItem("WebToken")!=""?localStorage.getItem("WebToken"):getCookie("WebToken")))}});AjaxLoad_XhrPush(n,u)})}function AjaxUpload_CustImg(n,t,i,r,u,f,e,o){$("#"+t).unbind("change");$("#"+t).change(function(){var s=[];let h=document.getElementById(t),e=h.files;if(e.length<=0||e.length>5)o!=undefined&&o!=null&&o();else{for(let t=0;t!=e.length;t++){let h=e[t],c=h.name,l=c.substring(c.lastIndexOf(".")),a=c.substring(0,c.lastIndexOf(".")),v=a.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-zA-Z0-9.\-_]/g,"-").replace(/-+/g,"-").replace(/^-+|-+$/g,"")+l,o=new File([h],v,{type:h.type,lastModified:h.lastModified}),y=o.size,p=(y/1048576).toFixed(2);p<3?s.push(AjaxUpload_CustImgExe(n,o,o.name,o.size,r,u,f)):i==1&&Imagesize_Resize(o,f,o.name,function(t,i){let e=new File([t],i,{type:t.type});s.push(AjaxUpload_CustImgExe(n,e,i,e.size,r,u,f))})}Promise.all(s).then(()=>{})}})}async function AjaxUpload_CustImgExe(n,t,i,r,u,f,e){return new Promise(o=>{let s=new FormData;s.append("files",t);$.ajax({url:n,data:s,processData:!1,contentType:!1,type:"POST",error:function(){f!=undefined&&f!=null&&f.length!=0&&f(i)},success:function(n){n!=undefined&&u!=undefined&&u!=null&&u.length!=0&&u(AjaxLoad_DecomJson(n),i,r);o(!0)},beforeSend:function(n){n.setRequestHeader("Authorization","Bearer "+(localStorage.getItem("WebToken")!=""?localStorage.getItem("WebToken"):getCookie("WebToken")));e!=undefined&&e!=null&&e.length!=0&&e(i)}})})}async function Imagesize_Resize(n,t,i,r){return new Promise(()=>{t(i);var u=new FileReader;u.onload=function(n){var t=new Image;t.onload=function(){var e=document.createElement("canvas"),f=Blodmax_size,n=t.width,u=t.height,o,s;n>u?n>f&&(u*=f/n,n=f):u>f&&(n*=f/u,u=f);e.width=n;e.height=u;e.getContext("2d").drawImage(t,0,0,n,u);o=e.toDataURL("image/jpeg");s=dataURLToBlob(o);r(s,i)};t.src=n.target.result};u.readAsDataURL(n)})}var Blodmax_size=1500,Local_TimeOut="TimeOut",LocalFlag_TimeOut=!1,Global_AjaxLoad={},dataURLToBlob=function(n){var u=";base64,",t;if(n.indexOf(u)==-1){var i=n.split(","),f=i[0].split(":")[1],r=i[1];return new Blob([r],{type:f})}var i=n.split(u),f=i[0].split(":")[1],r=window.atob(i[1]),e=r.length,o=new Uint8Array(e);for(t=0;t<e;++t)o[t]=r.charCodeAt(t);return new Blob([o],{type:f})};