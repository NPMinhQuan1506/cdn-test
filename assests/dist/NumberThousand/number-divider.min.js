/*!
 * jQuery number divider
 * Copyright (C) 2016, Mikhail Tyugaev
 * Licensed under the MIT license
 *
 * @author Mikhail Tyugaev
 * @version 1.0.0 (2016-11-25)
 */
(function(n){var i={delimiter:",",divideThousand:!0,delimiterRegExp:/[\,\s]/g},t=n.fn.val;n.fn.val=function(n){var i=this.data("divided");return typeof n=="undefined"?i?i.value:t.call(this):i?t.call(this,n).change():t.call(this,n)};n.fn.divide=function(t){function r(n){return!n.is("input, textarea")}function f(n){return!isNaN(n)}function u(n){var t,i,r,u;if(n=n.replace(options.delimiterRegExp,""),!f(n)&&n.length>0)return console.warn(n+" is not a number"),"0";for(t=n,i=10,t+="",r=0;r<i;r++)t=t.replace(",","");for(x=t.split("."),y=x[0],z=x.length>1?"."+(x[1]>2?x[1].slice(0,2):x[1]):"",u=/(\d+)(\d{3})/;u.test(y);)y=y.replace(u,"$1,$2");return i++,y+z}return options=n.extend({},i,t),this.each(function(){var t=n(this);!r(t)&&t.data("divided")&&t.unbind(".divide")}),this.each(function(){var t=n(this),i;if(r(t)){i=u(t.text());i!=-1&&t.text(i);return}t.bind("input.divide change.divide",function(){var r=this.value.replace(options.delimiterRegExp,""),f=u(r),n=t.data("divided"),i;f!=-1&&(n||(n={},i=t.attr("name"),i!=undefined?(t.attr("name",""),t.parent().append("<input type='hidden' name='"+i+"'>"),n.name=i):n.name=null),n.value=r,this.value=f,t.data("divided",n),n.name&&t.parent().children("input[name="+n.name+"]").val(r))});t.change()}),this}})(jQuery);